<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sikkim Road Route Planner</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Video background styling */
        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .video-background video {
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            object-fit: cover;
        }
        
        .video-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: -1;
        }
        
        body {
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            padding: 20px;
            margin-bottom: 20px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        @media (min-width: 768px) {
            .main-content {
                flex-direction: row;
            }
        }
        
        .map-container {
            flex: 1;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            height: 500px;
            background: rgba(44, 62, 80, 0.9);
            position: relative;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        #map {
            width: 100%;
            height: 100%;
        }
        
        .controls {
            width: 300px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .control-group h3 {
            margin-bottom: 10px;
            color: #2c3e50;
            border-bottom: 2px solid #eee;
            padding-bottom: 5px;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: none;
            border-radius: 6px;
            background: #3498db;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .btn-locate {
            background: #2ecc71;
        }
        
        .btn-locate:hover {
            background: #27ae60;
        }
        
        .route-info {
            background: rgba(249, 249, 249, 0.8);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .route-info h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .route-details {
            list-style: none;
        }
        
        .route-details li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        
        .route-details li:last-child {
            border-bottom: none;
        }
        
        .route-details i {
            margin-right: 10px;
            color: #3498db;
        }
        
        .search-box {
            display: flex;
            margin-bottom: 15px;
        }
        
        .search-box input {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px 0 0 6px;
            font-size: 16px;
        }
        
        .search-box button {
            padding: 12px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 0 6px 6px 0;
            cursor: pointer;
        }
        
        .sikkim-info {
            background: rgba(255, 243, 205, 0.9);
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin-top: 20px;
        }
        
        .sikkim-info h4 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            color: white;
            opacity: 0.9;
            font-size: 0.9rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }
        
        .loading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 1.5rem;
            z-index: 1000;
            border-radius: 12px;
        }
        
        .hidden {
            display: none;
        }
        
        .route-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .route-option {
            flex: 1;
            padding: 8px;
            border: 2px solid #3498db;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .route-option.active {
            background: #3498db;
            color: white;
        }
        
        .instructions {
            margin-top: 15px;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(245, 245, 245, 0.8);
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .instruction-step {
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px dashed #ddd;
        }
        
        .instruction-step:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
    </style>
</head>
<body>
    <!-- Video background -->
    <div class="video-background">
        <video autoplay muted loop>
            <source src="bg.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
    <div class="video-overlay"></div>

    <div class="container">
        <header>
            <h1>Sikkim Road Route Planner</h1>
            <p class="tagline">Find the best road route to beautiful Sikkim from your location</p>
        </header>
        
        <div class="main-content">
            <div class="map-container">
                <div id="map"></div>
                <div class="loading hidden" id="loading">
                    <div>
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Calculating route to Sikkim...</p>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <h3>Route Options</h3>
                    <div class="search-box">
                        <input type="text" id="start-location" placeholder="Enter starting location">
                        <button id="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <button class="btn btn-locate" id="locate-me">
                        <i class="fas fa-location-arrow"></i> Use My Current Location
                    </button>
                    
                    <div class="route-options">
                        <div class="route-option active" data-route="fastest">
                            <i class="fas fa-bolt"></i> Fastest
                        </div>
                        <div class="route-option" data-route="shortest">
                            <i class="fas fa-route"></i> Shortest
                        </div>
                        <div class="route-option" data-route="scenic">
                            <i class="fas fa-mountain"></i> Scenic
                        </div>
                    </div>
                    
                    <button class="btn" id="show-route">
                        <i class="fas fa-route"></i> Show Route to Sikkim
                    </button>
                </div>
                
                <div class="route-info">
                    <h4>Route Information</h4>
                    <ul class="route-details">
                        <li><i class="fas fa-road"></i> Distance: <span id="distance">-</span></li>
                        <li><i class="fas fa-clock"></i> Duration: <span id="duration">-</span></li>
                        <li><i class="fas fa-car"></i> Route Type: <span id="route-type">Fastest</span></li>
                        <li><i class="fas fa-map-marker-alt"></i> From: <span id="start-point">-</span></li>
                        <li><i class="fas fa-mountain"></i> To: Gangtok, Sikkim</li>
                    </ul>
                </div>
                
                <div class="instructions">
                    <h4>Route Instructions</h4>
                    <div id="instructions-list">
                        <div class="instruction-step">Enter a location and calculate route to see instructions</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>© 2023 Sikkim Road Route Planner | Experience the beauty of the Himalayas</p>
        </div>
    </div>

    <script>
        // Initialize the map
        const map = L.map('map').setView([27.5330, 88.5122], 8);
        
        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // Add a marker for Sikkim (Gangtok)
        const sikkimMarker = L.marker([27.3389, 88.6065]).addTo(map)
            .bindPopup('<b>Gangtok, Sikkim</b><br>Capital of Sikkim').openPopup();
        
        // Add a circle around Sikkim to highlight it
        const sikkimCircle = L.circle([27.3389, 88.6065], {
            color: '#4caf50',
            fillColor: '#4caf50',
            fillOpacity: 0.2,
            radius: 30000
        }).addTo(map);
        
        // DOM elements
        const locateMeBtn = document.getElementById('locate-me');
        const showRouteBtn = document.getElementById('show-route');
        const searchBtn = document.getElementById('search-btn');
        const loadingElement = document.getElementById('loading');
        const distanceElement = document.getElementById('distance');
        const durationElement = document.getElementById('duration');
        const startPointElement = document.getElementById('start-point');
        const startLocationInput = document.getElementById('start-location');
        const routeTypeElement = document.getElementById('route-type');
        const instructionsList = document.getElementById('instructions-list');
        const routeOptions = document.querySelectorAll('.route-option');
        
        // Variables to store route and markers
        let currentRoute = null;
        let startMarker = null;
        let currentRouteType = 'fastest';
        
        // Set up route option selection
        routeOptions.forEach(option => {
            option.addEventListener('click', function() {
                routeOptions.forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                currentRouteType = this.getAttribute('data-route');
                routeTypeElement.textContent = this.getAttribute('data-route').charAt(0).toUpperCase() + this.getAttribute('data-route').slice(1);
            });
        });
        
        // Function to show loading state
        function showLoading() {
            loadingElement.classList.remove('hidden');
        }
        
        // Function to hide loading state
        function hideLoading() {
            loadingElement.classList.add('hidden');
        }
        
        // Function to update route information
        function updateRouteInfo(distance, duration, startPoint) {
            distanceElement.textContent = distance;
            durationElement.textContent = duration;
            startPointElement.textContent = startPoint;
        }
        
        // Function to clear existing route
        function clearRoute() {
            if (currentRoute) {
                map.removeLayer(currentRoute);
                currentRoute = null;
            }
            if (startMarker) {
                map.removeLayer(startMarker);
                startMarker = null;
            }
        }
        
        // Function to generate instructions based on route type
        function generateInstructions(routeType, distance) {
            instructionsList.innerHTML = '';
            
            const instructions = {
                fastest: [
                    "Take NH10 towards Siliguri",
                    "Continue on NH10 towards Sevoke",
                "Take the road towards Kalimpong",
                "Continue on NH717A towards Gangtok"
                ],
                shortest: [
                    "Take the state highway towards Darjeeling",
                    "Continue on Hill Cart Road",
                    "Take Peshok Road towards Gangtok",
                    "Follow the signs to Gangtok"
                ],
                scenic: [
                    "Take the route via Kalimpong for scenic views",
                    "Stop at Teesta River viewpoint",
                    "Continue on the mountain road with valley views",
                    "Pass through lush tea gardens",
                    "Take the route via Rumtek for monastery views"
                ]
            };
            
            // Add common instructions for all routes
            const commonInstructions = [
                "Check your vehicle condition before starting",
                "Carry necessary permits for Sikkim",
                "Fill up fuel at Siliguri"
            ];
            
            instructions[routeType].forEach(instruction => {
                const step = document.createElement('div');
                step.className = 'instruction-step';
                step.innerHTML = `<i class="fas fa-arrow-right"></i> ${instruction}`;
                instructionsList.appendChild(step);
            });
            
            commonInstructions.forEach(instruction => {
                const step = document.createElement('div');
                step.className = 'instruction-step';
                step.innerHTML = `<i class="fas fa-info-circle"></i> ${instruction}`;
                instructionsList.appendChild(step);
            });
        }
        
        // Function to draw a route on the map
        function drawRoute(startLat, startLng) {
            clearRoute();
            showLoading();
            
            // In a real application, you would use a routing service API here
            // For demonstration, we'll simulate a route after a short delay
            setTimeout(() => {
                // Different route simulations based on route type
                let routeCoordinates;
                
                if (currentRouteType === 'fastest') {
                    routeCoordinates = [
                        [startLat, startLng],
                        [26.7606, 88.3530],
                        [27.0330, 88.2622],
                        [27.3389, 88.6065]  // Gangtok, Sikkim
                    ];
                } else if (currentRouteType === 'shortest') {
                    routeCoordinates = [
                        [startLat, startLng],
                        [26.9000, 88.4000],
                        [27.1500, 88.3500],
                        [27.3389, 88.6065]  // Gangtok, Sikkim
                    ];
                } else { // scenic
                    routeCoordinates = [
                        [startLat, startLng],
                        [26.8000, 88.3000],
                        [27.0000, 88.2000],
                        [27.2000, 88.5000],
                        [27.3389, 88.6065]  // Gangtok, Sikkim
                    ];
                }
                
                // Draw the route on the map
                currentRoute = L.polyline(routeCoordinates, {
                    color: '#3498db',
                    weight: 6,
                    opacity: 0.7,
                    smoothFactor: 1
                }).addTo(map);
                
                // Fit the map to show the entire route
                map.fitBounds(currentRoute.getBounds());
                
                // Add a marker at the start location
                startMarker = L.marker([startLat, startLng]).addTo(map)
                    .bindPopup('<b>Starting Point</b>').openPopup();
                
                // Calculate distance and duration (simulated)
                const distance = Math.round(calculateDistance(startLat, startLng, 27.3389, 88.6065)) + ' km';
                
                // Different estimated times based on route type
                let duration;
                if (currentRouteType === 'fastest') {
                    duration = Math.round(calculateDistance(startLat, startLng, 27.3389, 88.6065) / 50 * 60) + ' mins';
                } else if (currentRouteType === 'shortest') {
                    duration = Math.round(calculateDistance(startLat, startLng, 27.3389, 88.6065) / 45 * 60) + ' mins';
                } else {
                    duration = Math.round(calculateDistance(startLat, startLng, 27.3389, 88.6065) / 40 * 60) + ' mins';
                }
                
                // Update route information
                updateRouteInfo(distance, duration, `[${startLat.toFixed(4)}, ${startLng.toFixed(4)}]`);
                
                // Generate instructions
                generateInstructions(currentRouteType, distance);
                
                hideLoading();
            }, 1500);
        }
        
        // Function to calculate distance between two points (simplified)
        function calculateDistance(lat1, lon1, lat2, lon2) {
            // Haversine formula simplified for demonstration
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                0.5 - Math.cos(dLat)/2 + 
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                (1 - Math.cos(dLon)) / 2;
            
            return R * 2 * Math.asin(Math.sqrt(a));
        }
        
        // Event listener for "Use My Current Location" button
        locateMeBtn.addEventListener('click', () => {
            if (!navigator.geolocation) {
                alert('Geolocation is not supported by your browser');
                return;
            }
            
            showLoading();
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    
                    // Update the start location input
                    startLocationInput.value = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
                    
                    // Draw the route from current location to Sikkim
                    drawRoute(lat, lng);
                },
                (error) => {
                    hideLoading();
                    alert('Unable to retrieve your location. Please enter it manually.');
                    console.error('Geolocation error:', error);
                }
            );
        });
        
        // Event listener for "Show Route to Sikkim" button
        showRouteBtn.addEventListener('click', () => {
            const inputText = startLocationInput.value.trim();
            
            if (!inputText) {
                alert('Please enter a starting location or use "Use My Current Location"');
                return;
            }
            
            // Try to parse coordinates from input
            const coordMatch = inputText.match(/^(-?\d+\.?\d*)[,\s]+(-?\d+\.?\d*)$/);
            
            if (coordMatch) {
                const lat = parseFloat(coordMatch[1]);
                const lng = parseFloat(coordMatch[2]);
                
                if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {
                    alert('Please enter valid coordinates (latitude, longitude)');
                    return;
                }
                
                drawRoute(lat, lng);
            } else {
                // In a real application, you would geocode the location here
                alert('Please enter coordinates in "lat, lng" format. For example: "28.7041, 77.1025"');
                
                // For demo purposes, we'll use a fixed location (New Delhi)
                drawRoute(28.7041, 77.1025);
                startLocationInput.value = "28.7041, 77.1025";
            }
        });
        
        // Event listener for search button
        searchBtn.addEventListener('click', showRouteBtn.click.bind(showRouteBtn));
        
        // Allow pressing Enter in the input field
        startLocationInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                showRouteBtn.click();
            }
        });
        
        // Initialize with a sample route from New Delhi
        window.addEventListener('load', () => {
            startLocationInput.value = "28.7041, 77.1025";
            drawRoute(28.7041, 77.1025);
        });
    </script>
</body>
</html>